<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="/public/stylesheet/admin.css">
</head>
<body>
  <div class="container">
   
    <header class="header">
      <h1>Welcome, <%= admin.name %>!</h1>
      <a href="/logout" class="logout-btn">Logout</a>
    </header>

    
    <div class="side-panel">
      <button class="top-issues-btn" onclick="fetchTopIssues()">Top Issues</button>
    </div>

    <div class="main-content">
      <h2>Top Issues</h2>
      <div id="issues-list" class="issues-list">
        <p>No issues to display. Click "Top Issues" to fetch them.</p>
      </div>
    </div>
  </div>

  
  <script>
    async function fetchTopIssues() {
      try {
        const response = await fetch('/admin/topIssues', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' }
        });

        if (response.ok) {
          const issues = await response.json();
          const issuesList = document.getElementById('issues-list');

          
          issuesList.innerHTML = '';

          if (issues.length > 0) {
            issues.forEach(issue => {
              const issueCard = document.createElement('div');
              issueCard.classList.add('issue-card');
              issueCard.innerHTML = `
                <h4>${issue.title}</h4>
                <p>${issue.description || 'No description available'}</p>
                <p>Votes: üëç ${issue.upVotes.length} | üëé ${issue.downVotes.length}</p>
                <p>Upvote Priority: ${issue.upVotes.length} votes</p>
              `;
              issuesList.appendChild(issueCard);
            });
          } else {
            issuesList.innerHTML = '<p>No issues found.</p>';
          }
        } else {
          alert('Failed to fetch top issues. Please try again.');
        }
      } catch (error) {
        console.error('Error fetching top issues:', error);
        alert('An error occurred while fetching top issues.');
      }
    }
  </script>
</body>
</html>
